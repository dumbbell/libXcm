Summary:        X Color Management Library
Name:           libXcm
License:        MIT
Group:          System Environment/Libraries
URL:            http://www.oyranos.org
Vendor:         Kai-Uwe Behrmann
#BuildArch: %{_arch}
#%ifos linux
#%endif 
BuildRoot: %{_tmppath}/%{name}-root
Prefix:    %{_prefix}


%if 0%{?suse_version} > 0
BuildRequires:     gcc-c++ gettext pkgconfig    xorg-x11-Mesa xorg-x11-Mesa-devel doxygen
%endif
%if 0%{?suse_version} > 910
#BuildRequires: gcc-c++ gettext doxygen fltk-threaded fltk-threaded-devel xorg-x11 xorg-x11-devel xorg-x11-Mesa-devel  pkgconfig libpng-devel libjpeg-devel
BuildRequires:  bash bind-utils binutils bison bzip2 coreutils cpio cyrus-sasl diffutils e2fsprogs file filesystem findutils gcc gcc-c++ glibc glibc-devel grep groff gzip less make man mktemp patch perl pkgconfig popt readline rpm sed tar timezone unzip util-linux zlib zlib-devel
%endif
%if 0%{?suse_version} > 1010
BuildRequires:  Mesa Mesa-devel gcc-c++ pkgconfig xorg-x11 xorg-x11-devel xorg-x11-libX11 xorg-x11-libX11-devel xorg-x11-libXfixes xorg-x11-libXfixes-devel xorg-x11-libs xorg-x11-util-devel
%endif
%if 0%{?mandriva_version} > 0
BuildRequires:  Mesa mesagl-devel gcc-c++ pkgconfig doxygen
%endif
%if 0%{?fedora_version} > 0
BuildRequires:  Mesa Mesa-devel gcc-c++ xorg-x11-devel xorg-x11-Mesa-devel xdg-utils doxygen libXfixes-devel xorg-x11-proto-devel xorg-x11-xtrans-devel

%endif
%if 0%{?debian_version} > 0
BuildRequires: gcc-c++ pkgconfig xorg-x11 xorg-x11-devel xorg-x11-Mesa-devel  xdg-utils doxygen
%endif


%package      -n %{name}0
Summary:   X Color Management Library
Group:     Development/Libraries/Other

%package      devel
Summary:   Headers, Configuration and static Libs + Documentation
Group:     Development/Libraries/Other
Requires:  %{name}0 = %{version}


%description
The libXcm library is colour management helper for Xorg. It contains a 
reference implementation of the net-color spec.
It allows to attach colour regions to X windows to communicate with colour
servers. A EDID parser and a observer tool are included.

%description -n %{name}0
The libXcm library is a reference implementation of the net-color spec.
It allows to attach colour regions to X windows to communicate with colour
servers. A EDID parser and a colour management event observer are included.

%description devel
The libXcm library is a reference implementation of the net-color spec.
It allows to attach colour regions to X windows to communicate with colour
servers. A EDID parser and a colour management event observer are included.
The package contains headers and other development files.



%prep
%setup -n %{name}-%{version}

%build
%configure --disable-static
make %{?_smp_mflags}

%install
make DESTDIR=%{buildroot} install-main

#Remove installed doc
rm -fr %{buildroot}/%{_datadir}/doc/%{name}

#Fix timestamp to prevent multilibs conflict
touch -r ChangeLog doc/man/*


%clean
rm -rf $RPM_BUILD_ROOT


%post -n %{name}0 -p /sbin/ldconfig

%postun -n %{name}0 -p /sbin/ldconfig


%files -n %{name}0
%defattr(-, root, root)
%{_libdir}/%{name}.so.*

%files devel
%defattr(-, root, root)
%doc AUTHORS COPYING ChangeLog README
%doc docs/net-color-spec
%{_libdir}/%{name}.so
%dir %{_includedir}/X11/Xcm
%{_includedir}/X11/Xcm/*.h
%{_libdir}/pkgconfig/xcm.pc
%{_mandir}/man3/*.3*


%changelog
* Fri Oct 01 2010 Kai-Uwe Behrmann
- include EDID parser - 0.3.0
- include Xcm Events API
- headers move to a own sub directory

* Mon Jul 19 2010 Kai-Uwe Behrmann
- sync with Nicolas Chauvet <kwizart@gmail.com> - 0.2.6-2

* Thu Jun 03 2010 Kai-Uwe Behrmann
- initial


